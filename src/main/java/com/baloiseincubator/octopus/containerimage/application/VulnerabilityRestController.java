package com.baloiseincubator.octopus.containerimage.application;

import com.baloiseincubator.octopus.containerimage.domain.Severity;
import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.Arrays;
import java.util.List;

@RestController
@RequiredArgsConstructor
@RequestMapping(path = "api/vulnerabilities")
public class VulnerabilityRestController {

    @GetMapping
    public List<ImageVulnerabilityDto> getImageVulnerabilities() {
        return Arrays.asList(
                new ImageVulnerabilityDto(
                        new ImageDto("example", "gitops-nginx-demo", "https://registry.baloise.dev/harbor/projects/2/repositories/example%2Fgitops-nginx-demo/tags/69de455111ff44fa96481c2f3e734195c7ad9bc3", "69de455111ff44fa96481c2f3e734195c7ad9bc3", "sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4"),
                        new VulnerabilityInfoDto(Severity.HIGH, Arrays.asList(
                            new VulnerabilityDto("https://www.linktomoredetails.com/thisexactone"),
                            new VulnerabilityDto("https://www.linktomoredetails.com/otherone")
                        ), Arrays.asList(
                                new SeveritySummaryDto(Severity.HIGH, 3, 3),
                                new SeveritySummaryDto(Severity.MEDIUM, 22, 18)
                        ))
                ),
                new ImageVulnerabilityDto(
                        new ImageDto("otherorg", "myrepo", "https://registry.baloise.dev/harbor/projects/2/repositories/example%2Fgitops-nginx-demo/tags/69de455111ff44fa96481c2f3e734195c7ad9bc3", "69de455111ff44fa96481c2f3e734195c7ad9bc3", "sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4"),
                        new VulnerabilityInfoDto(Severity.HIGH, Arrays.asList(
                                new VulnerabilityDto("https://www.linktomoredetails.com/thisexactone"),
                                new VulnerabilityDto("https://www.linktomoredetails.com/otherone")
                        ), Arrays.asList(
                                new SeveritySummaryDto(Severity.HIGH, 1, 1),
                                new SeveritySummaryDto(Severity.MEDIUM, 2, 2)
                        ))
                )
        );
    }
}
